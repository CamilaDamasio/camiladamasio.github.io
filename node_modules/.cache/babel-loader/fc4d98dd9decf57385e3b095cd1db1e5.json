{"ast":null,"code":"import _regeneratorRuntime from\"/home/camila/Repositorios_GitHub/sd-012-project-recipes-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/camila/Repositorios_GitHub/sd-012-project-recipes-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/home/camila/Repositorios_GitHub/sd-012-project-recipes-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/camila/Repositorios_GitHub/sd-012-project-recipes-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useSelector,useDispatch}from'react-redux';import{Redirect}from'react-router-dom';import{v4}from'uuid';import{Button}from'react-bootstrap';import{getCocktail}from'../redux/actions';import HeaderWithSearch from'../components/HeaderWithSearch';import Footer from'../components/Footer';import useCategories from'../hooks/useCategories';import{setLoading}from'../redux/actions/loading';import useRedirect from'../hooks/useRedirect';import LoadingSmall from'../components/LoadingSmall';function DrinksList(){var _useSelector=useSelector(function(state){return state;}),_useSelector$reducerA=_useSelector.reducerAPI,loading=_useSelector$reducerA.loading,cocktails=_useSelector$reducerA.cocktails;var dispatch=useDispatch();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),renderedCocktails=_useState2[0],setRenderedCocktails=_useState2[1];var _useState3=useState('all'),_useState4=_slicedToArray(_useState3,2),selected=_useState4[0],setSelected=_useState4[1];var TWELVE=12;var SELECTED_DRINK='cat selected-drink';var _useRedirect=useRedirect(),shouldRedirect=_useRedirect.shouldRedirect,redirect=_useRedirect.redirect;var _useSelector2=useSelector(function(state){return state.reducerAPI;}),search=_useSelector2.search,searchType=_useSelector2.searchType;useEffect(function(){dispatch(getCocktail(search,searchType));},[dispatch,searchType,search]);useEffect(function(){if(cocktails===null){global.alert('Sinto muito, não encontramos nenhuma receita para esses filtros.');}if(cocktails!==null&&cocktails.length>1){var newDrinks=_toConsumableArray(cocktails.slice(0,TWELVE));setRenderedCocktails(newDrinks);}},[cocktails]);var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),catList=_useState6[0],setCatList=_useState6[1];var CATURL='https://www.thecocktaildb.com/api/json/v1/1/list.php?c=list';var categories=useCategories(CATURL,'drinks');useEffect(function(){setCatList(categories);},[categories]);if(cocktails!==null&&cocktails.length===1){return/*#__PURE__*/React.createElement(Redirect,{to:\"/bebidas/\".concat(cocktails[0].idDrink)});}var handleClickAll=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var newCocktails;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setSelected('all');newCocktails=_toConsumableArray(cocktails.slice(0,TWELVE));setRenderedCocktails(newCocktails);case 3:case\"end\":return _context.stop();}}},_callee);}));return function handleClickAll(){return _ref.apply(this,arguments);};}();var handleClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(target,name){var url,results,firstTwelve;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(setLoading(true));if(!(target.className!==SELECTED_DRINK)){_context2.next=13;break;}setSelected(name);url=\"https://www.thecocktaildb.com/api/json/v1/1/filter.php?c=\".concat(name);_context2.next=6;return fetch(url).then(function(response){return response.json();});case 6:results=_context2.sent;_context2.next=9;return results.drinks.slice(0,TWELVE);case 9:firstTwelve=_context2.sent;setRenderedCocktails(firstTwelve);_context2.next=15;break;case 13:setSelected('all');handleClickAll();case 15:dispatch(setLoading(false));case 16:case\"end\":return _context2.stop();}}},_callee2);}));return function handleClick(_x,_x2){return _ref2.apply(this,arguments);};}();if(redirect.should)return/*#__PURE__*/React.createElement(Redirect,{to:redirect.path});return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(HeaderWithSearch,null,\"Bebidas\"),/*#__PURE__*/React.createElement(\"div\",{className:\"cat-btns\"},catList.map(function(_ref3){var strCategory=_ref3.strCategory;return/*#__PURE__*/React.createElement(Button,{variant:\"warning\",type:\"button\",key:v4(),onClick:function onClick(_ref4){var target=_ref4.target;return handleClick(target,strCategory);},\"data-testid\":\"\".concat(strCategory,\"-category-filter\"),className:selected===strCategory?SELECTED_DRINK:'cat not-selected'},strCategory);}),/*#__PURE__*/React.createElement(Button,{variant:\"warning\",type:\"button\",onClick:handleClickAll,\"data-testid\":\"All-category-filter\",className:selected==='all'?SELECTED_DRINK:'cat not-selected'},\"All\")),/*#__PURE__*/React.createElement(\"div\",{className:\"cards-list\"},loading?/*#__PURE__*/React.createElement(LoadingSmall,null):renderedCocktails.map(function(item,index){return/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:function onClick(){return shouldRedirect(\"/bebidas/\".concat(item.idDrink));},key:v4(),\"data-testid\":\"\".concat(index,\"-recipe-card\"),className:\"recipe-card\"},/*#__PURE__*/React.createElement(\"img\",{alt:\"drink\",src:item.strDrinkThumb,\"data-testid\":\"\".concat(index,\"-card-img\")}),/*#__PURE__*/React.createElement(\"h4\",{\"data-testid\":\"\".concat(index,\"-card-name\"),className:\"card-name\"},item.strDrink));})),/*#__PURE__*/React.createElement(Footer,null));}export default DrinksList;","map":{"version":3,"sources":["/home/camila/Repositorios_GitHub/sd-012-project-recipes-app/src/pages/DrinksList.jsx"],"names":["React","useEffect","useState","useSelector","useDispatch","Redirect","v4","Button","getCocktail","HeaderWithSearch","Footer","useCategories","setLoading","useRedirect","LoadingSmall","DrinksList","state","reducerAPI","loading","cocktails","dispatch","renderedCocktails","setRenderedCocktails","selected","setSelected","TWELVE","SELECTED_DRINK","shouldRedirect","redirect","search","searchType","global","alert","length","newDrinks","slice","catList","setCatList","CATURL","categories","idDrink","handleClickAll","newCocktails","handleClick","target","name","className","url","fetch","then","response","json","results","drinks","firstTwelve","should","path","map","strCategory","item","index","strDrinkThumb","strDrink"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Redirect } from 'react-router-dom';\nimport { v4 } from 'uuid';\nimport { Button } from 'react-bootstrap';\nimport { getCocktail } from '../redux/actions';\nimport HeaderWithSearch from '../components/HeaderWithSearch';\nimport Footer from '../components/Footer';\nimport useCategories from '../hooks/useCategories';\nimport { setLoading } from '../redux/actions/loading';\nimport useRedirect from '../hooks/useRedirect';\nimport LoadingSmall from '../components/LoadingSmall';\n\nfunction DrinksList() {\n  const { reducerAPI: { loading, cocktails } } = useSelector((state) => state);\n  const dispatch = useDispatch();\n  const [renderedCocktails, setRenderedCocktails] = useState([]);\n  const [selected, setSelected] = useState('all');\n  const TWELVE = 12;\n  const SELECTED_DRINK = 'cat selected-drink';\n  const { shouldRedirect, redirect } = useRedirect();\n  const { search, searchType } = useSelector((state) => state.reducerAPI);\n\n  useEffect(() => {\n    dispatch(getCocktail(search, searchType));\n  }, [dispatch, searchType, search]);\n\n  useEffect(() => {\n    if (cocktails === null) {\n      global.alert('Sinto muito, não encontramos nenhuma receita para esses filtros.');\n    }\n    if (cocktails !== null && cocktails.length > 1) {\n      const newDrinks = [...cocktails.slice(0, TWELVE)];\n      setRenderedCocktails(newDrinks);\n    }\n  }, [cocktails]);\n\n  const [catList, setCatList] = useState([]);\n  const CATURL = 'https://www.thecocktaildb.com/api/json/v1/1/list.php?c=list';\n  const categories = useCategories(CATURL, 'drinks');\n\n  useEffect(() => {\n    setCatList(categories);\n  }, [categories]);\n\n  if (cocktails !== null && cocktails.length === 1) {\n    return <Redirect to={ `/bebidas/${cocktails[0].idDrink}` } />;\n  }\n\n  const handleClickAll = async () => {\n    setSelected('all');\n    const newCocktails = [...cocktails.slice(0, TWELVE)];\n    setRenderedCocktails(newCocktails);\n  };\n\n  const handleClick = async (target, name) => {\n    dispatch(setLoading(true));\n    if (target.className !== SELECTED_DRINK) {\n      setSelected(name);\n      const url = `https://www.thecocktaildb.com/api/json/v1/1/filter.php?c=${name}`;\n      const results = await fetch(url).then((response) => response.json());\n      const firstTwelve = await results.drinks.slice(0, TWELVE);\n      setRenderedCocktails(firstTwelve);\n    } else {\n      setSelected('all');\n      handleClickAll();\n    }\n    dispatch(setLoading(false));\n  };\n\n  if (redirect.should) return <Redirect to={ redirect.path } />;\n\n  return (\n    <div>\n      <HeaderWithSearch>\n        Bebidas\n      </HeaderWithSearch>\n      <div className=\"cat-btns\">\n        { catList.map(({ strCategory }) => (\n          <Button\n            variant=\"warning\"\n            type=\"button\"\n            key={ v4() }\n            onClick={ ({ target }) => handleClick(target, strCategory) }\n            data-testid={ `${strCategory}-category-filter` }\n            className={ selected === strCategory ? SELECTED_DRINK : 'cat not-selected' }\n          >\n            {strCategory}\n          </Button>\n        ))}\n        <Button\n          variant=\"warning\"\n          type=\"button\"\n          onClick={ handleClickAll }\n          data-testid=\"All-category-filter\"\n          className={ selected === 'all' ? SELECTED_DRINK : 'cat not-selected' }\n        >\n          All\n        </Button>\n      </div>\n      <div className=\"cards-list\">\n        { loading ? <LoadingSmall /> : renderedCocktails.map((item, index) => (\n          <button\n            type=\"button\"\n            onClick={ () => shouldRedirect(`/bebidas/${item.idDrink}`) }\n            key={ v4() }\n            data-testid={ `${index}-recipe-card` }\n            className=\"recipe-card\"\n          >\n            <img\n              alt=\"drink\"\n              src={ item.strDrinkThumb }\n              data-testid={ `${index}-card-img` }\n            />\n            <h4\n              data-testid={ `${index}-card-name` }\n              className=\"card-name\"\n            >\n              {item.strDrink}\n            </h4>\n          </button>\n        ))}\n      </div>\n      <Footer />\n    </div>\n  );\n}\n\nexport default DrinksList;\n"]},"metadata":{},"sourceType":"module"}